文件名,SQL,执行时长
/root/tpc_ds_test/sql/query/query_s_0.sql,use tpc_test; select count(*) from store_sales ，household_demographics ，time_dim， store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 8 and time_dim.t_minute >= 30 and household_demographics.hd_dep_count = 5 and store.s_store_name = ese order by count(*) limit 100;,Fetched 1 row(s) in 0.75s
/root/tpc_ds_test/sql/query/query_s_10.sql,use tpc_test; select s_store_name， s_store_id， sum(case when (d_day_name=Sunday) then ss_sales_price else null end) sun_sales， sum(case when (d_day_name=Monday) then ss_sales_price else null end) mon_sales， sum(case when (d_day_name=Tuesday) then ss_sales_price else null end) tue_sales， sum(case when (d_day_name=Wednesday) then ss_sales_price else null end) wed_sales， sum(case when (d_day_name=Thursday) then ss_sales_price else null end) thu_sales， sum(case when (d_day_name=Friday) then ss_sales_price else null end) fri_sales， sum(case when (d_day_name=Saturday) then ss_sales_price else null end) sat_sales from date_dim， store_sales， store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -5 and d_year = 2000 group by s_store_name， s_store_id order by s_store_name， s_store_id，sun_sales，mon_sales，tue_sales，wed_sales，thu_sales，fri_sales，sat_sales limit 100;,Fetched 6 row(s) in 0.73s
/root/tpc_ds_test/sql/query/query_s_11.sql,use tpc_test; with ss_items as (select i_item_id item_id ，sum(ss_ext_sales_price) ss_item_rev from store_sales ，item ，date_dim where ss_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq = (select d_week_seq from date_dim where d_date = 2000-02-12)) and ss_sold_date_sk = d_date_sk group by i_item_id)， cs_items as (select i_item_id item_id ，sum(cs_ext_sales_price) cs_item_rev from catalog_sales ，item ，date_dim where cs_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq = (select d_week_seq from date_dim where d_date = 2000-02-12)) and cs_sold_date_sk = d_date_sk group by i_item_id)， ws_items as (select i_item_id item_id ，sum(ws_ext_sales_price) ws_item_rev from web_sales ，item ，date_dim where ws_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq =(select d_week_seq from date_dim where d_date = 2000-02-12)) and ws_sold_date_sk = d_date_sk group by i_item_id) select ss_items.item_id ，ss_item_rev ，ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev ，cs_item_rev ，cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev ，ws_item_rev ，ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev ，(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items，cs_items，ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id ，ss_item_rev limit 100;,Fetched 0 row(s) in 1.51s
/root/tpc_ds_test/sql/query/query_s_12.sql,use tpc_test; with cs_ui as (select cs_item_sk ，sum(cs_ext_list_price) as sale，sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ，catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit))， cross_sales as (select i_product_name product_name ，i_item_sk item_sk ，s_store_name store_name ，s_zip store_zip ，ad1.ca_street_number b_street_number ，ad1.ca_street_name b_street_name ，ad1.ca_city b_city ，ad1.ca_zip b_zip ，ad2.ca_street_number c_street_number ，ad2.ca_street_name c_street_name ，ad2.ca_city c_city ，ad2.ca_zip c_zip ，d1.d_year as syear ，d2.d_year as fsyear ，d3.d_year s2year ，count(*) cnt ，sum(ss_wholesale_cost) s1 ，sum(ss_list_price) s2 ，sum(ss_coupon_amt) s3 FROM store_sales ，store_returns ，cs_ui ，date_dim d1 ，date_dim d2 ，date_dim d3 ，store ，customer ，customer_demographics cd1 ，customer_demographics cd2 ，promotion ，household_demographics hd1 ，household_demographics hd2 ，customer_address ad1 ，customer_address ad2 ，income_band ib1 ，income_band ib2 ，item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_color in (light，cyan，burnished，green，almond，smoke) and i_current_price between 22 and 22 + 10 and i_current_price between 22 + 1 and 22 + 15 group by i_product_name ，i_item_sk ，s_store_name ，s_zip ，ad1.ca_street_number ，ad1.ca_street_name ，ad1.ca_city ，ad1.ca_zip ，ad2.ca_street_number ，ad2.ca_street_name ，ad2.ca_city ，ad2.ca_zip ，d1.d_year ，d2.d_year ，d3.d_year ) select cs1.product_name ，cs1.store_name ，cs1.store_zip ，cs1.b_street_number ，cs1.b_street_name ，cs1.b_city ，cs1.b_zip ，cs1.c_street_number ，cs1.c_street_name ，cs1.c_city ，cs1.c_zip ，cs1.syear ，cs1.cnt ，cs1.s1 as s11 ，cs1.s2 as s21 ，cs1.s3 as s31 ，cs2.s1 as s12 ，cs2.s2 as s22 ，cs2.s3 as s32 ，cs2.syear ，cs2.cnt from cross_sales cs1，cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 2001 and cs2.syear = 2001 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name ，cs1.store_name ，cs2.cnt ，cs1.s1 ，cs2.s1;,Fetched 0 row(s) in 2.32s
/root/tpc_ds_test/sql/query/query_s_13.sql,use tpc_test; with ss as ( select i_manufact_id，sum(ss_ext_sales_price) total_sales from store_sales， date_dim， customer_address， item where i_manufact_id in (select i_manufact_id from item where i_category in (Books)) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 4 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id)， cs as ( select i_manufact_id，sum(cs_ext_sales_price) total_sales from catalog_sales， date_dim， customer_address， item where i_manufact_id in (select i_manufact_id from item where i_category in (Books)) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 4 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id)， ws as ( select i_manufact_id，sum(ws_ext_sales_price) total_sales from web_sales， date_dim， customer_address， item where i_manufact_id in (select i_manufact_id from item where i_category in (Books)) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy = 4 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id ，sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100;,Fetched 0 row(s) in 0.96s
/root/tpc_ds_test/sql/query/query_s_14.sql,use tpc_test; select c_last_name ，c_first_name ，ca_city ，bought_city ，ss_ticket_number ，amt，profit from (select ss_ticket_number ，ss_customer_sk ，ca_city bought_city ，sum(ss_coupon_amt) amt ，sum(ss_net_profit) profit from store_sales，date_dim，store，household_demographics，customer_address where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and store_sales.ss_addr_sk = customer_address.ca_address_sk and (household_demographics.hd_dep_count = 3 or household_demographics.hd_vehicle_count= 1) and date_dim.d_dow in (6，0) and date_dim.d_year in (1999，1999+1，1999+2) and store.s_city in (Midway，Fairview，Fairview，Midway，Fairview) group by ss_ticket_number，ss_customer_sk，ss_addr_sk，ca_city) dn，customer，customer_address current_addr where ss_customer_sk = c_customer_sk and customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name ，c_first_name ，ca_city ，bought_city ，ss_ticket_number limit 100;,Fetched 100 row(s) in 1.25s
/root/tpc_ds_test/sql/query/query_s_15.sql,use tpc_test; select substr(w_warehouse_name，1，20) ，sm_type ，web_name ，sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as 30 days ，sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as 31-60 days ，sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as 61-90 days ，sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as 91-120 days ，sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as >120 days from web_sales ，warehouse ，ship_mode ，web_site ，date_dim where d_month_seq between 1217 and 1217 + 11 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name，1，20) ，sm_type ，web_name order by substr(w_warehouse_name，1，20) ，sm_type ，web_name limit 100;,Fetched 100 row(s) in 1.16s
/root/tpc_ds_test/sql/query/query_s_16.sql,use tpc_test; select * from (select i_manager_id ，sum(ss_sales_price) sum_sales ，avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from item ，store_sales ，date_dim ，store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1181，1181+1，1181+2，1181+3，1181+4，1181+5，1181+6，1181+7，1181+8，1181+9，1181+10，1181+11) and (( i_category in (Books，Children，Electronics) and i_class in (personal，portable，reference，self-help) and i_brand in (scholaramalgamalg #14，scholaramalgamalg #7， exportiunivamalg #9，scholaramalgamalg #9)) or( i_category in (Women，Music，Men) and i_class in (accessories，classical，fragrances，pants) and i_brand in (amalgimporto #1，edu packscholar #1，exportiimporto #1， importoamalg #1))) group by i_manager_id， d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id ，avg_monthly_sales ，sum_sales limit 100;,Fetched 0 row(s) in 0.84s
/root/tpc_ds_test/sql/query/query_s_17.sql,use tpc_test; select cd_gender， cd_marital_status， cd_education_status， count(*) cnt1， cd_purchase_estimate， count(*) cnt2， cd_credit_rating， count(*) cnt3 from customer c，customer_address ca，customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in (IN，VA，MS) and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales，date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2002 and d_moy between 2 and 2+2) and (not exists (select * from web_sales，date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 2002 and d_moy between 2 and 2+2) and not exists (select * from catalog_sales，date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 2002 and d_moy between 2 and 2+2)) group by cd_gender， cd_marital_status， cd_education_status， cd_purchase_estimate， cd_credit_rating order by cd_gender， cd_marital_status， cd_education_status， cd_purchase_estimate， cd_credit_rating limit 100;,Fetched 100 row(s) in 0.99s
/root/tpc_ds_test/sql/query/query_s_18.sql,use tpc_test; with ss as ( select i_item_id，sum(ss_ext_sales_price) total_sales from store_sales， date_dim， customer_address， item where i_item_id in (select i_item_id from item where i_category in (Shoes)) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 10 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id)， cs as ( select i_item_id，sum(cs_ext_sales_price) total_sales from catalog_sales， date_dim， customer_address， item where i_item_id in (select i_item_id from item where i_category in (Shoes)) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 10 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id)， ws as ( select i_item_id，sum(ws_ext_sales_price) total_sales from web_sales， date_dim， customer_address， item where i_item_id in (select i_item_id from item where i_category in (Shoes)) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 10 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id ，sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by i_item_id ，total_sales limit 100;,Fetched 0 row(s) in 0.90s
/root/tpc_ds_test/sql/query/query_s_19.sql,use tpc_test; with wss as (select d_week_seq， ss_store_sk， sum(case when (d_day_name=Sunday) then ss_sales_price else null end) sun_sales， sum(case when (d_day_name=Monday) then ss_sales_price else null end) mon_sales， sum(case when (d_day_name=Tuesday) then ss_sales_price else null end) tue_sales， sum(case when (d_day_name=Wednesday) then ss_sales_price else null end) wed_sales， sum(case when (d_day_name=Thursday) then ss_sales_price else null end) thu_sales， sum(case when (d_day_name=Friday) then ss_sales_price else null end) fri_sales， sum(case when (d_day_name=Saturday) then ss_sales_price else null end) sat_sales from store_sales，date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq，ss_store_sk ) select s_store_name1，s_store_id1，d_week_seq1 ，sun_sales1/sun_sales2，mon_sales1/mon_sales2 ，tue_sales1/tue_sales2，wed_sales1/wed_sales2，thu_sales1/thu_sales2 ，fri_sales1/fri_sales2，sat_sales1/sat_sales2 from (select s_store_name s_store_name1，wss.d_week_seq d_week_seq1 ，s_store_id s_store_id1，sun_sales sun_sales1 ，mon_sales mon_sales1，tue_sales tue_sales1 ，wed_sales wed_sales1，thu_sales thu_sales1 ，fri_sales fri_sales1，sat_sales sat_sales1 from wss，store，date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1206 and 1206 + 11) y， (select s_store_name s_store_name2，wss.d_week_seq d_week_seq2 ，s_store_id s_store_id2，sun_sales sun_sales2 ，mon_sales mon_sales2，tue_sales tue_sales2 ，wed_sales wed_sales2，thu_sales thu_sales2 ，fri_sales fri_sales2，sat_sales sat_sales2 from wss，store，date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1206+ 12 and 1206 + 23) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1，s_store_id1，d_week_seq1 limit 100;,Fetched 100 row(s) in 0.93s
/root/tpc_ds_test/sql/query/query_s_1.sql,use tpc_test; select i_item_id， avg(ss_quantity) agg1， avg(ss_list_price) agg2， avg(ss_coupon_amt) agg3， avg(ss_sales_price) agg4 from store_sales， customer_demographics， date_dim， item， promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = M and cd_marital_status = M and cd_education_status = 4 yr Degree and (p_channel_email = N or p_channel_event = N) and d_year = 2001 group by i_item_id order by i_item_id limit 100;,Fetched 0 row(s) in 0.83s
/root/tpc_ds_test/sql/query/query_s_20.sql,use tpc_test; select substr(r_reason_desc，1，20) ，avg(ws_quantity) ，avg(wr_refunded_cash) ，avg(wr_fee) from web_sales， web_returns， web_page， customer_demographics cd1， customer_demographics cd2， customer_address， date_dim， reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = D and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = Primary and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = U and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = Unknown and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = M and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = Advanced Degree and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = United States and ca_state in (SC， IN， VA) and ws_net_profit between 100 and 200 ) or ( ca_country = United States and ca_state in (WA， KS， KY) and ws_net_profit between 150 and 300 ) or ( ca_country = United States and ca_state in (SD， WI， NE) and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substr(r_reason_desc，1，20) ，avg(ws_quantity) ，avg(wr_refunded_cash) ，avg(wr_fee) limit 100;,Fetched 0 row(s) in 0.95s
/root/tpc_ds_test/sql/query/query_s_21.sql,use tpc_test; select * from (select avg(ss_list_price) B1_LP ，count(ss_list_price) B1_CNT ，count(distinct ss_list_price) B1_CNTD from store_sales where ss_quantity between 0 and 5 and (ss_list_price between 28 and 28+10 or ss_coupon_amt between 12573 and 12573+1000 or ss_wholesale_cost between 33 and 33+20)) B1， (select avg(ss_list_price) B2_LP ，count(ss_list_price) B2_CNT ，count(distinct ss_list_price) B2_CNTD from store_sales where ss_quantity between 6 and 10 and (ss_list_price between 143 and 143+10 or ss_coupon_amt between 5562 and 5562+1000 or ss_wholesale_cost between 45 and 45+20)) B2， (select avg(ss_list_price) B3_LP ，count(ss_list_price) B3_CNT ，count(distinct ss_list_price) B3_CNTD from store_sales where ss_quantity between 11 and 15 and (ss_list_price between 159 and 159+10 or ss_coupon_amt between 2807 and 2807+1000 or ss_wholesale_cost between 24 and 24+20)) B3， (select avg(ss_list_price) B4_LP ，count(ss_list_price) B4_CNT ，count(distinct ss_list_price) B4_CNTD from store_sales where ss_quantity between 16 and 20 and (ss_list_price between 24 and 24+10 or ss_coupon_amt between 3706 and 3706+1000 or ss_wholesale_cost between 46 and 46+20)) B4， (select avg(ss_list_price) B5_LP ，count(ss_list_price) B5_CNT ，count(distinct ss_list_price) B5_CNTD from store_sales where ss_quantity between 21 and 25 and (ss_list_price between 76 and 76+10 or ss_coupon_amt between 2096 and 2096+1000 or ss_wholesale_cost between 50 and 50+20)) B5， (select avg(ss_list_price) B6_LP ，count(ss_list_price) B6_CNT ，count(distinct ss_list_price) B6_CNTD from store_sales where ss_quantity between 26 and 30 and (ss_list_price between 169 and 169+10 or ss_coupon_amt between 10672 and 10672+1000 or ss_wholesale_cost between 58 and 58+20)) B6 limit 100;,Fetched 1 row(s) in 0.46s
/root/tpc_ds_test/sql/query/query_s_22.sql,use tpc_test; with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk ，ca_state as ctr_state， sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ，date_dim ，customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ，ca_state ) select c_customer_id，c_salutation，c_first_name，c_last_name，ca_street_number，ca_street_name ，ca_street_type，ca_suite_number，ca_city，ca_county，ca_state，ca_zip，ca_country，ca_gmt_offset ，ca_location_type，ctr_total_return from customer_total_return ctr1 ，customer_address ，customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = TX and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id，c_salutation，c_first_name，c_last_name，ca_street_number，ca_street_name ，ca_street_type，ca_suite_number，ca_city，ca_county，ca_state，ca_zip，ca_country，ca_gmt_offset ，ca_location_type，ctr_total_return limit 100;,Fetched 100 row(s) in 0.36s
/root/tpc_ds_test/sql/query/query_s_23.sql,use tpc_test; with ssci as ( select ss_customer_sk customer_sk ，ss_item_sk item_sk from store_sales，date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1211 and 1211 + 11 group by ss_customer_sk ，ss_item_sk)， csci as( select cs_bill_customer_sk customer_sk ，cs_item_sk item_sk from catalog_sales，date_dim where cs_sold_date_sk = d_date_sk and d_month_seq between 1211 and 1211 + 11 group by cs_bill_customer_sk ，cs_item_sk) select sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only ，sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only ，sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk and ssci.item_sk = csci.item_sk) limit 100;,Fetched 1 row(s) in 0.54s
/root/tpc_ds_test/sql/query/query_s_24.sql,use tpc_test; select cast(amc as decimal(15，4))/cast(pmc as decimal(15，4)) am_pm_ratio from ( select count(*) amc from web_sales， household_demographics ， time_dim， web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 9 and 9+1 and household_demographics.hd_dep_count = 2 and web_page.wp_char_count between 5000 and 5200) ati， ( select count(*) pmc from web_sales， household_demographics ， time_dim， web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 15 and 15+1 and household_demographics.hd_dep_count = 2 and web_page.wp_char_count between 5000 and 5200) pt order by am_pm_ratio limit 100;,Fetched 1 row(s) in 0.65s
/root/tpc_ds_test/sql/query/query_s_25.sql,use tpc_test; select i_item_id ，i_item_desc ，s_state ，count(ss_quantity) as store_sales_quantitycount ，avg(ss_quantity) as store_sales_quantityave ，stddev_samp(ss_quantity) as store_sales_quantitystdev ，stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov ，count(sr_return_quantity) as store_returns_quantitycount ，avg(sr_return_quantity) as store_returns_quantityave ，stddev_samp(sr_return_quantity) as store_returns_quantitystdev ，stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov ，count(cs_quantity) as catalog_sales_quantitycount ，avg(cs_quantity) as catalog_sales_quantityave ，stddev_samp(cs_quantity) as catalog_sales_quantitystdev ，stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov from store_sales ，store_returns ，catalog_sales ，date_dim d1 ，date_dim d2 ，date_dim d3 ，store ，item where d1.d_quarter_name = 1999Q1 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_quarter_name in (1999Q1，1999Q2，1999Q3) and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_quarter_name in (1999Q1，1999Q2，1999Q3) group by i_item_id ，i_item_desc ，s_state order by i_item_id ，i_item_desc ，s_state limit 100;,Fetched 0 row(s) in 0.85s
/root/tpc_ds_test/sql/query/query_s_26.sql,use tpc_test; with v1 as( select i_category， i_brand， s_store_name， s_company_name， d_year， d_moy， sum(ss_sales_price) sum_sales， avg(sum(ss_sales_price)) over (partition by i_category， i_brand， s_store_name， s_company_name， d_year) avg_monthly_sales， rank() over (partition by i_category， i_brand， s_store_name， s_company_name order by d_year， d_moy) rn from item， store_sales， date_dim， store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ( d_year = 2001 or ( d_year = 2001-1 and d_moy =12) or ( d_year = 2001+1 and d_moy =1) ) group by i_category， i_brand， s_store_name， s_company_name， d_year， d_moy)， v2 as( select v1.i_category， v1.i_brand， v1.s_store_name， v1.s_company_name ，v1.d_year ，v1.avg_monthly_sales ，v1.sum_sales， v1_lag.sum_sales psum， v1_lead.sum_sales nsum from v1， v1 v1_lag， v1 v1_lead where v1.i_category = v1_lag.i_category and v1.i_category = v1_lead.i_category and v1.i_brand = v1_lag.i_brand and v1.i_brand = v1_lead.i_brand and v1.s_store_name = v1_lag.s_store_name and v1.s_store_name = v1_lead.s_store_name and v1.s_company_name = v1_lag.s_company_name and v1.s_company_name = v1_lead.s_company_name and v1.rn = v1_lag.rn + 1 and v1.rn = v1_lead.rn - 1) select * from v2 where d_year = 2001 and avg_monthly_sales > 0 and case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by sum_sales - avg_monthly_sales， nsum limit 100;,Fetched 100 row(s) in 1.46s
/root/tpc_ds_test/sql/query/query_s_27.sql,use tpc_test; select dt.d_year ，item.i_brand_id brand_id ，item.i_brand brand ，sum(ss_net_profit) sum_agg from date_dim dt ，store_sales ，item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manufact_id = 445 and dt.d_moy=12 group by dt.d_year ，item.i_brand ，item.i_brand_id order by dt.d_year ，sum_agg desc ，brand_id limit 100;,Fetched 49 row(s) in 0.55s
/root/tpc_ds_test/sql/query/query_s_28.sql,use tpc_test; WITH web_v1 as ( select ws_item_sk item_sk， d_date， sum(sum(ws_sales_price)) over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales ，date_dim where ws_sold_date_sk=d_date_sk and d_month_seq between 1215 and 1215+11 and ws_item_sk is not NULL group by ws_item_sk， d_date)， store_v1 as ( select ss_item_sk item_sk， d_date， sum(sum(ss_sales_price)) over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales ，date_dim where ss_sold_date_sk=d_date_sk and d_month_seq between 1215 and 1215+11 and ss_item_sk is not NULL group by ss_item_sk， d_date) select * from (select item_sk ，d_date ，web_sales ，store_sales ，max(web_sales) over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative ，max(store_sales) over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk ，case when web.d_date is not null then web.d_date else store.d_date end d_date ，web.cume_sales web_sales ，store.cume_sales store_sales from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk and web.d_date = store.d_date) )x )y where web_cumulative > store_cumulative order by item_sk ，d_date limit 100;,Fetched 100 row(s) in 1.28s
/root/tpc_ds_test/sql/query/query_s_29.sql,use tpc_test; with ss as (select ca_county，d_qoy， d_year，sum(ss_ext_sales_price) as store_sales from store_sales，date_dim，customer_address where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk group by ca_county，d_qoy， d_year)， ws as (select ca_county，d_qoy， d_year，sum(ws_ext_sales_price) as web_sales from web_sales，date_dim，customer_address where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk group by ca_county，d_qoy， d_year) select ss1.ca_county ，ss1.d_year ，ws2.web_sales/ws1.web_sales web_q1_q2_increase ，ss2.store_sales/ss1.store_sales store_q1_q2_increase ，ws3.web_sales/ws2.web_sales web_q2_q3_increase ，ss3.store_sales/ss2.store_sales store_q2_q3_increase from ss ss1 ，ss ss2 ，ss ss3 ，ws ws1 ，ws ws2 ，ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.ca_county;,Fetched 43 row(s) in 2.15s
/root/tpc_ds_test/sql/query/query_s_2.sql,use tpc_test; WITH all_sales AS ( SELECT d_year ，i_brand_id ，i_class_id ，i_category_id ，i_manufact_id ，SUM(sales_cnt) AS sales_cnt ，SUM(sales_amt) AS sales_amt FROM (SELECT d_year ，i_brand_id ，i_class_id ，i_category_id ，i_manufact_id ，cs_quantity - COALESCE(cr_return_quantity，0) AS sales_cnt ，cs_ext_sales_price - COALESCE(cr_return_amount，0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk JOIN date_dim ON d_date_sk=cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number AND cs_item_sk=cr_item_sk) WHERE i_category=Shoes UNION SELECT d_year ，i_brand_id ，i_class_id ，i_category_id ，i_manufact_id ，ss_quantity - COALESCE(sr_return_quantity，0) AS sales_cnt ，ss_ext_sales_price - COALESCE(sr_return_amt，0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk=ss_item_sk JOIN date_dim ON d_date_sk=ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number AND ss_item_sk=sr_item_sk) WHERE i_category=Shoes UNION SELECT d_year ，i_brand_id ，i_class_id ，i_category_id ，i_manufact_id ，ws_quantity - COALESCE(wr_return_quantity，0) AS sales_cnt ，ws_ext_sales_price - COALESCE(wr_return_amt，0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk=ws_item_sk JOIN date_dim ON d_date_sk=ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number=wr_order_number AND ws_item_sk=wr_item_sk) WHERE i_category=Shoes) sales_detail GROUP BY d_year， i_brand_id， i_class_id， i_category_id， i_manufact_id) SELECT prev_yr.d_year AS prev_year ，curr_yr.d_year AS year ，curr_yr.i_brand_id ，curr_yr.i_class_id ，curr_yr.i_category_id ，curr_yr.i_manufact_id ，prev_yr.sales_cnt AS prev_yr_cnt ，curr_yr.sales_cnt AS curr_yr_cnt ，curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff ，curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff FROM all_sales curr_yr， all_sales prev_yr WHERE curr_yr.i_brand_id=prev_yr.i_brand_id AND curr_yr.i_class_id=prev_yr.i_class_id AND curr_yr.i_category_id=prev_yr.i_category_id AND curr_yr.i_manufact_id=prev_yr.i_manufact_id AND curr_yr.d_year=2000 AND prev_yr.d_year=2000-1 AND CAST(curr_yr.sales_cnt AS DECIMAL(17，2))/CAST(prev_yr.sales_cnt AS DECIMAL(17，2))<0.9 ORDER BY sales_cnt_diff，sales_amt_diff limit 100;,Fetched 0 row(s) in 1.36s
/root/tpc_ds_test/sql/query/query_s_30.sql,use tpc_test; with year_total as ( select c_customer_id customer_id ，c_first_name customer_first_name ，c_last_name customer_last_name ，c_preferred_cust_flag customer_preferred_cust_flag ，c_birth_country customer_birth_country ，c_login customer_login ，c_email_address customer_email_address ，d_year dyear ，sum(ss_ext_list_price-ss_ext_discount_amt) year_total ，s sale_type from customer ，store_sales ，date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk group by c_customer_id ，c_first_name ，c_last_name ，c_preferred_cust_flag ，c_birth_country ，c_login ，c_email_address ，d_year union all select c_customer_id customer_id ，c_first_name customer_first_name ，c_last_name customer_last_name ，c_preferred_cust_flag customer_preferred_cust_flag ，c_birth_country customer_birth_country ，c_login customer_login ，c_email_address customer_email_address ，d_year dyear ，sum(ws_ext_list_price-ws_ext_discount_amt) year_total ，w sale_type from customer ，web_sales ，date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk group by c_customer_id ，c_first_name ，c_last_name ，c_preferred_cust_flag ，c_birth_country ，c_login ，c_email_address ，d_year ) select t_s_secyear.customer_id ，t_s_secyear.customer_first_name ，t_s_secyear.customer_last_name ，t_s_secyear.customer_email_address from year_total t_s_firstyear ，year_total t_s_secyear ，year_total t_w_firstyear ，year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.sale_type = s and t_w_firstyear.sale_type = w and t_s_secyear.sale_type = s and t_w_secyear.sale_type = w and t_s_firstyear.dyear = 1999 and t_s_secyear.dyear = 1999+1 and t_w_firstyear.dyear = 1999 and t_w_secyear.dyear = 1999+1 and t_s_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end order by t_s_secyear.customer_id ，t_s_secyear.customer_first_name ，t_s_secyear.customer_last_name ，t_s_secyear.customer_email_address limit 100;,Fetched 90 row(s) in 1.96s
/root/tpc_ds_test/sql/query/query_s_31.sql,use tpc_test; select ss_customer_sk ，sum(act_sales) sumsales from (select ss_item_sk ，ss_ticket_number ，ss_customer_sk ，case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number) ，reason where sr_reason_sk = r_reason_sk and r_reason_desc = Did not get it on time) t group by ss_customer_sk order by sumsales， ss_customer_sk limit 100;,Fetched 0 row(s) in 0.83s
/root/tpc_ds_test/sql/query/query_s_32.sql,use tpc_test; select i_item_id ，i_item_desc ，s_store_id ，s_store_name ，stddev_samp(ss_quantity) as store_sales_quantity ，stddev_samp(sr_return_quantity) as store_returns_quantity ，stddev_samp(cs_quantity) as catalog_sales_quantity from store_sales ，store_returns ，catalog_sales ，date_dim d1 ，date_dim d2 ，date_dim d3 ，store ，item where d1.d_moy = 4 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy between 4 and 4 + 3 and d2.d_year = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_year in (1999，1999+1，1999+2) group by i_item_id ，i_item_desc ，s_store_id ，s_store_name order by i_item_id ，i_item_desc ，s_store_id ，s_store_name limit 100;,Fetched 0 row(s) in 0.84s
/root/tpc_ds_test/sql/query/query_s_33.sql,use tpc_test; select * from( select i_category， i_class， i_brand， s_store_name， s_company_name， d_moy， sum(ss_sales_price) sum_sales， avg(sum(ss_sales_price)) over (partition by i_category， i_brand， s_store_name， s_company_name) avg_monthly_sales from item， store_sales， date_dim， store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (2001) and ((i_category in (Children，Jewelry，Home) and i_class in (infants，birdal，flatware) ) or (i_category in (Electronics，Music，Books) and i_class in (audio，classical，science) )) group by i_category， i_class， i_brand， s_store_name， s_company_name， d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales， s_store_name limit 100;,Fetched 0 row(s) in 1.03s
/root/tpc_ds_test/sql/query/query_s_34.sql,use tpc_test; select ca_zip ，sum(cs_sales_price) from catalog_sales ，customer ，customer_address ，date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip，1，5) in (85669， 86197，88274，83405，86475， 85392， 85460， 80348， 81792) or ca_state in (CA，WA，GA) or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 2002 group by ca_zip order by ca_zip limit 100;,Fetched 100 row(s) in 0.54s
/root/tpc_ds_test/sql/query/query_s_35.sql,use tpc_test; select a.ca_state state， count(*) cnt from customer_address a ，customer c ，store_sales s ，date_dim d ，item i where a.ca_address_sk = c.c_current_addr_sk and c.c_customer_sk = s.ss_customer_sk and s.ss_sold_date_sk = d.d_date_sk and s.ss_item_sk = i.i_item_sk and d.d_month_seq = (select distinct (d_month_seq) from date_dim where d_year = 1998 and d_moy = 3 ) and i.i_current_price > 1.2 * (select avg(j.i_current_price) from item j where j.i_category = i.i_category) group by a.ca_state having count(*) >= 10 order by cnt， a.ca_state limit 100;,Fetched 44 row(s) in 1.56s
/root/tpc_ds_test/sql/query/query_s_36.sql,use tpc_test; select dt.d_year ，item.i_brand_id brand_id ，item.i_brand brand ，sum(ss_ext_sales_price) ext_price from date_dim dt ，store_sales ，item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=2000 group by dt.d_year ，item.i_brand ，item.i_brand_id order by dt.d_year ，ext_price desc ，brand_id limit 100 ;,Fetched 100 row(s) in 0.66s
/root/tpc_ds_test/sql/query/query_s_37.sql,use tpc_test; select s_store_name ，s_company_id ，s_street_number ，s_street_name ，s_street_type ，s_suite_number ，s_city ，s_county ，s_state ，s_zip ，sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end) as 30 days ，sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end ) as 31-60 days ，sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end) as 61-90 days ，sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end) as 91-120 days ，sum(case when (sr_returned_date_sk - ss_sold_date_sk > 120) then 1 else 0 end) as >120 days from store_sales ，store_returns ，store ，date_dim d1 ，date_dim d2 where d2.d_year = 2002 and d2.d_moy = 8 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk = d1.d_date_sk and sr_returned_date_sk = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by s_store_name ，s_company_id ，s_street_number ，s_street_name ，s_street_type ，s_suite_number ，s_city ，s_county ，s_state ，s_zip order by s_store_name ，s_company_id ，s_street_number ，s_street_name ，s_street_type ，s_suite_number ，s_city ，s_county ，s_state ，s_zip limit 100;,Fetched 6 row(s) in 1.45s
/root/tpc_ds_test/sql/query/query_s_38.sql,use tpc_test; select dt.d_year ，item.i_category_id ，item.i_category ，sum(ss_ext_sales_price) from date_dim dt ，store_sales ，item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year ，item.i_category_id ，item.i_category order by sum(ss_ext_sales_price) desc，dt.d_year ，item.i_category_id ，item.i_category limit 100 ;,Fetched 10 row(s) in 0.63s
/root/tpc_ds_test/sql/query/query_s_39.sql,use tpc_test; select distinct(i_product_name) from item i1 where i_manufact_id between 668 and 668+40 and (select count(*) as item_cnt from item where (i_manufact = i1.i_manufact and ((i_category = Women and (i_color = cream or i_color = ghost) and (i_units = Ton or i_units = Gross) and (i_size = economy or i_size = small) ) or (i_category = Women and (i_color = midnight or i_color = burlywood) and (i_units = Tsp or i_units = Bundle) and (i_size = medium or i_size = extra large) ) or (i_category = Men and (i_color = lavender or i_color = azure) and (i_units = Each or i_units = Lb) and (i_size = large or i_size = N/A) ) or (i_category = Men and (i_color = chocolate or i_color = steel) and (i_units = N/A or i_units = Dozen) and (i_size = economy or i_size = small) ))) or (i_manufact = i1.i_manufact and ((i_category = Women and (i_color = floral or i_color = royal) and (i_units = Unknown or i_units = Tbl) and (i_size = economy or i_size = small) ) or (i_category = Women and (i_color = navy or i_color = forest) and (i_units = Bunch or i_units = Dram) and (i_size = medium or i_size = extra large) ) or (i_category = Men and (i_color = cyan or i_color = indian) and (i_units = Carton or i_units = Cup) and (i_size = large or i_size = N/A) ) or (i_category = Men and (i_color = coral or i_color = pale) and (i_units = Pallet or i_units = Gram) and (i_size = economy or i_size = small) )))) > 0 order by i_product_name limit 100;,Fetched 0 row(s) in 0.12s
/root/tpc_ds_test/sql/query/query_s_3.sql,use tpc_test; with inv as (select w_warehouse_name，w_warehouse_sk，i_item_sk，d_moy ，stdev，mean， case mean when 0 then null else stdev/mean end cov from(select w_warehouse_name，w_warehouse_sk，i_item_sk，d_moy ，stddev_samp(inv_quantity_on_hand) stdev，avg(inv_quantity_on_hand) mean from inventory ，item ，warehouse ，date_dim where inv_item_sk = i_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_year =2001 group by w_warehouse_name，w_warehouse_sk，i_item_sk，d_moy) foo where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk，inv1.i_item_sk，inv1.d_moy，inv1.mean， inv1.cov ，inv2.w_warehouse_sk，inv2.i_item_sk，inv2.d_moy，inv2.mean， inv2.cov from inv inv1，inv inv2 where inv1.i_item_sk = inv2.i_item_sk and inv1.w_warehouse_sk = inv2.w_warehouse_sk and inv1.d_moy=1 and inv2.d_moy=1+1 order by inv1.w_warehouse_sk，inv1.i_item_sk，inv1.d_moy，inv1.mean，inv1.cov ，inv2.d_moy，inv2.mean， inv2.cov ;,Fetched 243 row(s) in 1.04s
/root/tpc_ds_test/sql/query/query_s_40.sql,use tpc_test; select * from (select count(*) h8_30_to_9 from store_sales， household_demographics ， time_dim， store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 8 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2)) and store.s_store_name = ese) s1， (select count(*) h9_to_9_30 from store_sales， household_demographics ， time_dim， store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 9 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2)) and store.s_store_name = ese) s2， (select count(*) h9_30_to_10 from store_sales， household_demographics ， time_dim， store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 9 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2)) and store.s_store_name = ese) s3， (select count(*) h10_to_10_30 from store_sales， household_demographics ， time_dim， store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 10 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2)) and store.s_store_name = ese) s4， (select count(*) h10_30_to_11 from store_sales， household_demographics ， time_dim， store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 10 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2)) and store.s_store_name = ese) s5， (select count(*) h11_to_11_30 from store_sales， household_demographics ， time_dim， store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 11 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2)) and store.s_store_name = ese) s6， (select count(*) h11_30_to_12 from store_sales， household_demographics ， time_dim， store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 11 and time_dim.t_minute >= 30 and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2)) and store.s_store_name = ese) s7， (select count(*) h12_to_12_30 from store_sales， household_demographics ， time_dim， store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 12 and time_dim.t_minute < 30 and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2)) and store.s_store_name = ese) s8 ;,Fetched 1 row(s) in 1.10s
/root/tpc_ds_test/sql/query/query_s_41.sql,use tpc_test; with v1 as( select i_category， i_brand， cc_name， d_year， d_moy， sum(cs_sales_price) sum_sales， avg(sum(cs_sales_price)) over (partition by i_category， i_brand， cc_name， d_year) avg_monthly_sales， rank() over (partition by i_category， i_brand， cc_name order by d_year， d_moy) rn from item， catalog_sales， date_dim， call_center where cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and cc_call_center_sk= cs_call_center_sk and ( d_year = 2000 or ( d_year = 2000-1 and d_moy =12) or ( d_year = 2000+1 and d_moy =1) ) group by i_category， i_brand， cc_name ， d_year， d_moy)， v2 as( select v1.cc_name ，v1.d_year， v1.d_moy ，v1.avg_monthly_sales ，v1.sum_sales， v1_lag.sum_sales psum， v1_lead.sum_sales nsum from v1， v1 v1_lag， v1 v1_lead where v1.i_category = v1_lag.i_category and v1.i_category = v1_lead.i_category and v1.i_brand = v1_lag.i_brand and v1.i_brand = v1_lead.i_brand and v1. cc_name = v1_lag. cc_name and v1. cc_name = v1_lead. cc_name and v1.rn = v1_lag.rn + 1 and v1.rn = v1_lead.rn - 1) select * from v2 where d_year = 2000 and avg_monthly_sales > 0 and case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by sum_sales - avg_monthly_sales， psum limit 100;,Fetched 100 row(s) in 1.20s
/root/tpc_ds_test/sql/query/query_s_42.sql,use tpc_test; select s_store_name， i_item_desc， sc.revenue， i_current_price， i_wholesale_cost， i_brand from store， item， (select ss_store_sk， avg(revenue) as ave from (select ss_store_sk， ss_item_sk， sum(ss_sales_price) as revenue from store_sales， date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1186 and 1186+11 group by ss_store_sk， ss_item_sk) sa group by ss_store_sk) sb， (select ss_store_sk， ss_item_sk， sum(ss_sales_price) as revenue from store_sales， date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1186 and 1186+11 group by ss_store_sk， ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name， i_item_desc limit 100;,Fetched 100 row(s) in 1.38s
/root/tpc_ds_test/sql/query/query_s_43.sql,use tpc_test; select i_brand_id brand_id， i_brand brand，t_hour，t_minute， sum(ext_price) ext_price from item， (select ws_ext_sales_price as ext_price， ws_sold_date_sk as sold_date_sk， ws_item_sk as sold_item_sk， ws_sold_time_sk as time_sk from web_sales，date_dim where d_date_sk = ws_sold_date_sk and d_moy=11 and d_year=2001 union all select cs_ext_sales_price as ext_price， cs_sold_date_sk as sold_date_sk， cs_item_sk as sold_item_sk， cs_sold_time_sk as time_sk from catalog_sales，date_dim where d_date_sk = cs_sold_date_sk and d_moy=11 and d_year=2001 union all select ss_ext_sales_price as ext_price， ss_sold_date_sk as sold_date_sk， ss_item_sk as sold_item_sk， ss_sold_time_sk as time_sk from store_sales，date_dim where d_date_sk = ss_sold_date_sk and d_moy=11 and d_year=2001 ) tmp，time_dim where sold_item_sk = i_item_sk and i_manager_id=1 and time_sk = t_time_sk and (t_meal_time = breakfast or t_meal_time = dinner) group by i_brand， i_brand_id，t_hour，t_minute order by ext_price desc， i_brand_id ;,Fetched 0 row(s) in 1.16s
/root/tpc_ds_test/sql/query/query_s_44.sql,use tpc_test; select c_last_name ，c_first_name ，c_salutation ，c_preferred_cust_flag ，ss_ticket_number ，cnt from (select ss_ticket_number ，ss_customer_sk ，count(*) cnt from store_sales，date_dim，store，household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28) and (household_demographics.hd_buy_potential = 501-1000 or household_demographics.hd_buy_potential = Unknown) and household_demographics.hd_vehicle_count > 0 and (case when household_demographics.hd_vehicle_count > 0 then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end) > 1.2 and date_dim.d_year in (2000，2000+1，2000+2) and store.s_county in (Williamson County，Williamson County，Williamson County，Williamson County， Williamson County，Williamson County，Williamson County，Williamson County) group by ss_ticket_number，ss_customer_sk) dn，customer where ss_customer_sk = c_customer_sk and cnt between 15 and 20 order by c_last_name，c_first_name，c_salutation，c_preferred_cust_flag desc， ss_ticket_number;,Fetched 0 row(s) in 0.75s
/root/tpc_ds_test/sql/query/query_s_45.sql,use tpc_test; select sum (ss_quantity) from store_sales， store， customer_demographics， customer_address， date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and ( ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = W and cd_education_status = 2 yr Degree and ss_sales_price between 100.00 and 150.00 ) or ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = S and cd_education_status = Advanced Degree and ss_sales_price between 50.00 and 100.00 ) or ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = D and cd_education_status = Primary and ss_sales_price between 150.00 and 200.00 ) ) and ( ( ss_addr_sk = ca_address_sk and ca_country = United States and ca_state in (IL， KY， OR) and ss_net_profit between 0 and 2000 ) or (ss_addr_sk = ca_address_sk and ca_country = United States and ca_state in (VA， FL， AL) and ss_net_profit between 150 and 3000 ) or (ss_addr_sk = ca_address_sk and ca_country = United States and ca_state in (OK， IA， TX) and ss_net_profit between 50 and 25000 ) ) ;,Fetched 1 row(s) in 1.53s
/root/tpc_ds_test/sql/query/query_s_46.sql,use tpc_test; with year_total as ( select c_customer_id customer_id ，c_first_name customer_first_name ，c_last_name customer_last_name ，d_year as year ，stddev_samp(ss_net_paid) year_total ，s sale_type from customer ，store_sales ，date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (2001，2001+1) group by c_customer_id ，c_first_name ，c_last_name ，d_year union all select c_customer_id customer_id ，c_first_name customer_first_name ，c_last_name customer_last_name ，d_year as year ，stddev_samp(ws_net_paid) year_total ，w sale_type from customer ，web_sales ，date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year in (2001，2001+1) group by c_customer_id ，c_first_name ，c_last_name ，d_year ) select t_s_secyear.customer_id， t_s_secyear.customer_first_name， t_s_secyear.customer_last_name from year_total t_s_firstyear ，year_total t_s_secyear ，year_total t_w_firstyear ，year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.sale_type = s and t_w_firstyear.sale_type = w and t_s_secyear.sale_type = s and t_w_secyear.sale_type = w and t_s_firstyear.year = 2001 and t_s_secyear.year = 2001+1 and t_w_firstyear.year = 2001 and t_w_secyear.year = 2001+1 and t_s_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end order by 3，2，1 limit 100;,Fetched 92 row(s) in 1.42s
/root/tpc_ds_test/sql/query/query_s_47.sql,use tpc_test; select c_last_name ，c_first_name ，c_salutation ，c_preferred_cust_flag ，ss_ticket_number ，cnt from (select ss_ticket_number ，ss_customer_sk ，count(*) cnt from store_sales，date_dim，store，household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and date_dim.d_dom between 1 and 2 and (household_demographics.hd_buy_potential = 1001-5000 or household_demographics.hd_buy_potential = 5001-10000) and household_demographics.hd_vehicle_count > 0 and case when household_demographics.hd_vehicle_count > 0 then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1 and date_dim.d_year in (1999，1999+1，1999+2) and store.s_county in (Williamson County，Williamson County，Williamson County，Williamson County) group by ss_ticket_number，ss_customer_sk) dj，customer where ss_customer_sk = c_customer_sk and cnt between 1 and 5 order by cnt desc， c_last_name asc;,Fetched 0 row(s) in 0.74s
/root/tpc_ds_test/sql/query/query_s_48.sql,use tpc_test; with my_customers as ( select distinct c_customer_sk ， c_current_addr_sk from ( select cs_sold_date_sk sold_date_sk， cs_bill_customer_sk customer_sk， cs_item_sk item_sk from catalog_sales union all select ws_sold_date_sk sold_date_sk， ws_bill_customer_sk customer_sk， ws_item_sk item_sk from web_sales ) cs_or_ws_sales， item， date_dim， customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = Men and i_class = shirts and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 4 and d_year = 1998 ) ， my_revenue as ( select c_customer_sk， sum(ss_ext_sales_price) as revenue from my_customers， store_sales， customer_address， store， date_dim where c_current_addr_sk = ca_address_sk and ca_county = s_county and ca_state = s_state and ss_sold_date_sk = d_date_sk and c_customer_sk = ss_customer_sk and d_month_seq between (select distinct d_month_seq+1 from date_dim where d_year = 1998 and d_moy = 4) and (select distinct d_month_seq+3 from date_dim where d_year = 1998 and d_moy = 4) group by c_customer_sk ) ， segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment， count(*) as num_customers， segment*50 as segment_base from segments group by segment order by segment， num_customers limit 100;,Fetched 0 row(s) in 0.97s
/root/tpc_ds_test/sql/query/query_s_49.sql,use tpc_test; select i_brand_id brand_id， i_brand brand， sum(ss_ext_sales_price) ext_price from date_dim， store_sales， item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=20 and d_moy=12 and d_year=1998 group by i_brand， i_brand_id order by ext_price desc， i_brand_id limit 100 ;,Fetched 100 row(s) in 0.66s
/root/tpc_ds_test/sql/query/query_s_4.sql,use tpc_test; with inv as (select w_warehouse_name，w_warehouse_sk，i_item_sk，d_moy ，stdev，mean， case mean when 0 then null else stdev/mean end cov from(select w_warehouse_name，w_warehouse_sk，i_item_sk，d_moy ，stddev_samp(inv_quantity_on_hand) stdev，avg(inv_quantity_on_hand) mean from inventory ，item ，warehouse ，date_dim where inv_item_sk = i_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_year =2001 group by w_warehouse_name，w_warehouse_sk，i_item_sk，d_moy) foo where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk，inv1.i_item_sk，inv1.d_moy，inv1.mean， inv1.cov ，inv2.w_warehouse_sk，inv2.i_item_sk，inv2.d_moy，inv2.mean， inv2.cov from inv inv1，inv inv2 where inv1.i_item_sk = inv2.i_item_sk and inv1.w_warehouse_sk = inv2.w_warehouse_sk and inv1.d_moy=1 and inv2.d_moy=1+1 and inv1.cov > 1.5 order by inv1.w_warehouse_sk，inv1.i_item_sk，inv1.d_moy，inv1.mean，inv1.cov ，inv2.d_moy，inv2.mean， inv2.cov ;,Fetched 14 row(s) in 0.97s
/root/tpc_ds_test/sql/query/query_s_50.sql,use tpc_test; with ss as ( select i_item_id，sum(ss_ext_sales_price) total_sales from store_sales， date_dim， customer_address， item where i_item_id in (select i_item_id from item where i_color in (powder，goldenrod，bisque)) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1998 and d_moy = 5 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_item_id)， cs as ( select i_item_id，sum(cs_ext_sales_price) total_sales from catalog_sales， date_dim， customer_address， item where i_item_id in (select i_item_id from item where i_color in (powder，goldenrod，bisque)) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1998 and d_moy = 5 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_item_id)， ws as ( select i_item_id，sum(ws_ext_sales_price) total_sales from web_sales， date_dim， customer_address， item where i_item_id in (select i_item_id from item where i_color in (powder，goldenrod，bisque)) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1998 and d_moy = 5 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_item_id) select i_item_id ，sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales， i_item_id limit 100;,Fetched 0 row(s) in 0.86s
/root/tpc_ds_test/sql/query/query_s_51.sql,use tpc_test; select i_item_id， avg(cs_quantity) agg1， avg(cs_list_price) agg2， avg(cs_coupon_amt) agg3， avg(cs_sales_price) agg4 from catalog_sales， customer_demographics， date_dim， item， promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = F and cd_marital_status = M and cd_education_status = 4 yr Degree and (p_channel_email = N or p_channel_event = N) and d_year = 2000 group by i_item_id order by i_item_id limit 100;,Fetched 0 row(s) in 0.94s
/root/tpc_ds_test/sql/query/query_s_52.sql,use tpc_test; select * from (select i_manufact_id， sum(ss_sales_price) sum_sales， avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item， store_sales， date_dim， store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1197，1197+1，1197+2，1197+3，1197+4，1197+5，1197+6，1197+7，1197+8，1197+9，1197+10，1197+11) and ((i_category in (Books，Children，Electronics) and i_class in (personal，portable，reference，self-help) and i_brand in (scholaramalgamalg #14，scholaramalgamalg #7， exportiunivamalg #9，scholaramalgamalg #9)) or(i_category in (Women，Music，Men) and i_class in (accessories，classical，fragrances，pants) and i_brand in (amalgimporto #1，edu packscholar #1，exportiimporto #1， importoamalg #1))) group by i_manufact_id， d_qoy ) tmp1 where case when avg_quarterly_sales > 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end > 0.1 order by avg_quarterly_sales， sum_sales， i_manufact_id limit 100;,Fetched 0 row(s) in 0.84s
/root/tpc_ds_test/sql/query/query_s_53.sql,use tpc_test; select c_last_name，c_first_name，substr(s_city，1，30)，ss_ticket_number，amt，profit from (select ss_ticket_number ，ss_customer_sk ，store.s_city ，sum(ss_coupon_amt) amt ，sum(ss_net_profit) profit from store_sales，date_dim，store，household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 4) and date_dim.d_dow = 1 and date_dim.d_year in (1999，1999+1，1999+2) and store.s_number_employees between 200 and 295 group by ss_ticket_number，ss_customer_sk，ss_addr_sk，store.s_city) ms，customer where ss_customer_sk = c_customer_sk order by c_last_name，c_first_name，substr(s_city，1，30)， profit limit 100;,Fetched 100 row(s) in 1.08s
/root/tpc_ds_test/sql/query/query_s_54.sql,use tpc_test; select avg(ss_quantity) ，avg(ss_ext_sales_price) ，avg(ss_ext_wholesale_cost) ，sum(ss_ext_wholesale_cost) from store_sales ，store ，customer_demographics ，household_demographics ，customer_address ，date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = U and cd_education_status = 4 yr Degree and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = S and cd_education_status = Unknown and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = D and cd_education_status = 2 yr Degree and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = United States and ca_state in (CO， MI， MN) and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = United States and ca_state in (NC， NY， TX) and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = United States and ca_state in (CA， NE， TN) and ss_net_profit between 50 and 250 )) ;,Fetched 1 row(s) in 1.34s
/root/tpc_ds_test/sql/query/query_s_55.sql,use tpc_test; with year_total as ( select c_customer_id customer_id ，c_first_name customer_first_name ，c_last_name customer_last_name ，c_preferred_cust_flag customer_preferred_cust_flag ，c_birth_country customer_birth_country ，c_login customer_login ，c_email_address customer_email_address ，d_year dyear ，sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total ，s sale_type from customer ，store_sales ，date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk group by c_customer_id ，c_first_name ，c_last_name ，c_preferred_cust_flag ，c_birth_country ，c_login ，c_email_address ，d_year union all select c_customer_id customer_id ，c_first_name customer_first_name ，c_last_name customer_last_name ，c_preferred_cust_flag customer_preferred_cust_flag ，c_birth_country customer_birth_country ，c_login customer_login ，c_email_address customer_email_address ，d_year dyear ，sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total ，c sale_type from customer ，catalog_sales ，date_dim where c_customer_sk = cs_bill_customer_sk and cs_sold_date_sk = d_date_sk group by c_customer_id ，c_first_name ，c_last_name ，c_preferred_cust_flag ，c_birth_country ，c_login ，c_email_address ，d_year union all select c_customer_id customer_id ，c_first_name customer_first_name ，c_last_name customer_last_name ，c_preferred_cust_flag customer_preferred_cust_flag ，c_birth_country customer_birth_country ，c_login customer_login ，c_email_address customer_email_address ，d_year dyear ，sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total ，w sale_type from customer ，web_sales ，date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk group by c_customer_id ，c_first_name ，c_last_name ，c_preferred_cust_flag ，c_birth_country ，c_login ，c_email_address ，d_year ) select t_s_secyear.customer_id ，t_s_secyear.customer_first_name ，t_s_secyear.customer_last_name ，t_s_secyear.customer_email_address from year_total t_s_firstyear ，year_total t_s_secyear ，year_total t_c_firstyear ，year_total t_c_secyear ，year_total t_w_firstyear ，year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_c_secyear.customer_id and t_s_firstyear.customer_id = t_c_firstyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.sale_type = s and t_c_firstyear.sale_type = c and t_w_firstyear.sale_type = w and t_s_secyear.sale_type = s and t_c_secyear.sale_type = c and t_w_secyear.sale_type = w and t_s_firstyear.dyear = 2001 and t_s_secyear.dyear = 2001+1 and t_c_firstyear.dyear = 2001 and t_c_secyear.dyear = 2001+1 and t_w_firstyear.dyear = 2001 and t_w_secyear.dyear = 2001+1 and t_s_firstyear.year_total > 0 and t_c_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end order by t_s_secyear.customer_id ，t_s_secyear.customer_first_name ，t_s_secyear.customer_last_name ，t_s_secyear.customer_email_address limit 100;,Fetched 8 row(s) in 2.90s
/root/tpc_ds_test/sql/query/query_s_56.sql,use tpc_test; select substr(w_warehouse_name，1，20) ，sm_type ，cc_name ，sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as 30 days ，sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as 31-60 days ，sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as 61-90 days ，sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as 91-120 days ，sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as >120 days from catalog_sales ，warehouse ，ship_mode ，call_center ，date_dim where d_month_seq between 1188 and 1188 + 11 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name，1，20) ，sm_type ，cc_name order by substr(w_warehouse_name，1，20) ，sm_type ，cc_name limit 100;,Fetched 90 row(s) in 1.19s
/root/tpc_ds_test/sql/query/query_s_57.sql,use tpc_test; select c_last_name ，c_first_name ，ca_city ，bought_city ，ss_ticket_number ，extended_price ，extended_tax ，list_price from (select ss_ticket_number ，ss_customer_sk ，ca_city bought_city ，sum(ss_ext_sales_price) extended_price ，sum(ss_ext_list_price) list_price ，sum(ss_ext_tax) extended_tax from store_sales ，date_dim ，store ，household_demographics ，customer_address where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and store_sales.ss_addr_sk = customer_address.ca_address_sk and date_dim.d_dom between 1 and 2 and (household_demographics.hd_dep_count = 8 or household_demographics.hd_vehicle_count= 3) and date_dim.d_year in (2000，2000+1，2000+2) and store.s_city in (Midway，Fairview) group by ss_ticket_number ，ss_customer_sk ，ss_addr_sk，ca_city) dn ，customer ，customer_address current_addr where ss_customer_sk = c_customer_sk and customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name ，ss_ticket_number limit 100;,Fetched 100 row(s) in 1.28s
/root/tpc_ds_test/sql/query/query_s_58.sql,use tpc_test; with sr_items as (select i_item_id item_id， sum(sr_return_quantity) sr_item_qty from store_returns， item， date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in (2000-04-29，2000-09-09，2000-11-02))) and sr_returned_date_sk = d_date_sk group by i_item_id)， cr_items as (select i_item_id item_id， sum(cr_return_quantity) cr_item_qty from catalog_returns， item， date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in (2000-04-29，2000-09-09，2000-11-02))) and cr_returned_date_sk = d_date_sk group by i_item_id)， wr_items as (select i_item_id item_id， sum(wr_return_quantity) wr_item_qty from web_returns， item， date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in (2000-04-29，2000-09-09，2000-11-02))) and wr_returned_date_sk = d_date_sk group by i_item_id) select sr_items.item_id ，sr_item_qty ，sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev ，cr_item_qty ，cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev ，wr_item_qty ，wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev ，(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ，cr_items ，wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ，sr_item_qty limit 100;,Fetched 34 row(s) in 1.09s
/root/tpc_ds_test/sql/query/query_s_59.sql,use tpc_test; select promotions，total，cast(promotions as decimal(15，4))/cast(total as decimal(15，4))*100 from (select sum(ss_ext_sales_price) promotions from store_sales ，store ，promotion ，date_dim ，customer ，customer_address ，item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_promo_sk = p_promo_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = Sports and (p_channel_dmail = Y or p_channel_email = Y or p_channel_tv = Y) and s_gmt_offset = -6 and d_year = 2002 and d_moy = 11) promotional_sales， (select sum(ss_ext_sales_price) total from store_sales ，store ，date_dim ，customer ，customer_address ，item where ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ss_customer_sk= c_customer_sk and ca_address_sk = c_current_addr_sk and ss_item_sk = i_item_sk and ca_gmt_offset = -6 and i_category = Sports and s_gmt_offset = -6 and d_year = 2002 and d_moy = 11) all_sales order by promotions， total limit 100;,Fetched 1 row(s) in 0.88s
/root/tpc_ds_test/sql/query/query_s_5.sql,use tpc_test; select i_brand_id brand_id， i_brand brand， i_manufact_id， i_manufact， sum(ss_ext_sales_price) ext_price from date_dim， store_sales， item，customer，customer_address，store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=8 and d_moy=11 and d_year=1999 and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and substr(ca_zip，1，5) <> substr(s_zip，1，5) and ss_store_sk = s_store_sk group by i_brand ，i_brand_id ，i_manufact_id ，i_manufact order by ext_price desc ，i_brand ，i_brand_id ，i_manufact_id ，i_manufact limit 100 ;,Fetched 100 row(s) in 0.79s
/root/tpc_ds_test/sql/query/query_s_60.sql,use tpc_test; select channel， col_name， d_year， d_qoy， i_category， COUNT(*) sales_cnt， SUM(ext_sales_price) sales_amt FROM ( SELECT store as channel， ss_customer_sk col_name， d_year， d_qoy， i_category， ss_ext_sales_price ext_sales_price FROM store_sales， item， date_dim WHERE ss_customer_sk IS NULL AND ss_sold_date_sk=d_date_sk AND ss_item_sk=i_item_sk UNION ALL SELECT web as channel， ws_ship_hdemo_sk col_name， d_year， d_qoy， i_category， ws_ext_sales_price ext_sales_price FROM web_sales， item， date_dim WHERE ws_ship_hdemo_sk IS NULL AND ws_sold_date_sk=d_date_sk AND ws_item_sk=i_item_sk UNION ALL SELECT catalog as channel， cs_bill_customer_sk col_name， d_year， d_qoy， i_category， cs_ext_sales_price ext_sales_price FROM catalog_sales， item， date_dim WHERE cs_bill_customer_sk IS NULL AND cs_sold_date_sk=d_date_sk AND cs_item_sk=i_item_sk) foo GROUP BY channel， col_name， d_year， d_qoy， i_category ORDER BY channel， col_name， d_year， d_qoy， i_category limit 100;,Fetched 100 row(s) in 1.21s
/root/tpc_ds_test/sql/query/query_s_6.sql,use tpc_test; select i_item_id ，i_item_desc ，s_store_id ，s_store_name ，min(ss_net_profit) as store_sales_profit ，min(sr_net_loss) as store_returns_loss ，min(cs_net_profit) as catalog_sales_profit from store_sales ，store_returns ，catalog_sales ，date_dim d1 ，date_dim d2 ，date_dim d3 ，store ，item where d1.d_moy = 4 and d1.d_year = 2002 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy between 4 and 10 and d2.d_year = 2002 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy between 4 and 10 and d3.d_year = 2002 group by i_item_id ，i_item_desc ，s_store_id ，s_store_name order by i_item_id ，i_item_desc ，s_store_id ，s_store_name limit 100;,Fetched 0 row(s) in 0.84s
/root/tpc_ds_test/sql/query/query_s_7.sql,use tpc_test; with ws as (select d_year AS ws_sold_year， ws_item_sk， ws_bill_customer_sk ws_customer_sk， sum(ws_quantity) ws_qty， sum(ws_wholesale_cost) ws_wc， sum(ws_sales_price) ws_sp from web_sales left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year， ws_item_sk， ws_bill_customer_sk )， cs as (select d_year AS cs_sold_year， cs_item_sk， cs_bill_customer_sk cs_customer_sk， sum(cs_quantity) cs_qty， sum(cs_wholesale_cost) cs_wc， sum(cs_sales_price) cs_sp from catalog_sales left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year， cs_item_sk， cs_bill_customer_sk )， ss as (select d_year AS ss_sold_year， ss_item_sk， ss_customer_sk， sum(ss_quantity) ss_qty， sum(ss_wholesale_cost) ss_wc， sum(ss_sales_price) ss_sp from store_sales left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year， ss_item_sk， ss_customer_sk ) select ss_customer_sk， round(ss_qty/(coalesce(ws_qty，0)+coalesce(cs_qty，0))，2) ratio， ss_qty store_qty， ss_wc store_wholesale_cost， ss_sp store_sales_price， coalesce(ws_qty，0)+coalesce(cs_qty，0) other_chan_qty， coalesce(ws_wc，0)+coalesce(cs_wc，0) other_chan_wholesale_cost， coalesce(ws_sp，0)+coalesce(cs_sp，0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty，0)>0 or coalesce(cs_qty， 0)>0) and ss_sold_year=2001 order by ss_customer_sk， ss_qty desc， ss_wc desc， ss_sp desc， other_chan_qty， other_chan_wholesale_cost， other_chan_sales_price， ratio limit 100;,Fetched 100 row(s) in 1.11s
/root/tpc_ds_test/sql/query/query_s_8.sql,use tpc_test; with customer_total_return as (select sr_customer_sk as ctr_customer_sk ，sr_store_sk as ctr_store_sk ，sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ，date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 group by sr_customer_sk ，sr_store_sk) select c_customer_id from customer_total_return ctr1 ，store ，customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = TN and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id limit 100;,Fetched 100 row(s) in 1.28s
/root/tpc_ds_test/sql/query/query_s_9.sql,use tpc_test; select cc_call_center_id Call_Center， cc_name Call_Center_Name， cc_manager Manager， sum(cr_net_loss) Returns_Loss from call_center， catalog_returns， date_dim， customer， customer_address， customer_demographics， household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2002 and d_moy = 11 and ( (cd_marital_status = M and cd_education_status = Unknown) or(cd_marital_status = W and cd_education_status = Advanced Degree)) and hd_buy_potential like Unknown% and ca_gmt_offset = -6 group by cc_call_center_id，cc_name，cc_manager，cd_marital_status，cd_education_status order by sum(cr_net_loss) desc;,Fetched 0 row(s) in 0.83s
